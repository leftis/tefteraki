/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
/**
 * @fileOverview The "colorbutton" plugin that makes it possible to assign
 *               text and background colors to editor contents.
 *
 */
CKEDITOR.plugins.add("colorbutton",{requires:["panelbutton","floatpanel","styles"],init:function(e){function i(t,r,i){var o=CKEDITOR.tools.getNextId()+"_colorBox";e.ui.add(t,CKEDITOR.UI_PANELBUTTON,{label:i,title:i,className:"cke_button_"+t.toLowerCase(),modes:{wysiwyg:1},panel:{css:e.skin.editor.css,attributes:{role:"listbox","aria-label":n.panelTitle}},onBlock:function(t,n){n.autoSize=!0,n.element.addClass("cke_colorblock"),n.element.setHtml(s(t,r,o)),n.element.getDocument().getBody().setStyle("overflow","hidden"),CKEDITOR.ui.fire("ready",this);var i=n.keys,u=e.lang.dir=="rtl";i[u?37:39]="next",i[40]="next",i[9]="next",i[u?39:37]="prev",i[38]="prev",i[CKEDITOR.SHIFT+9]="prev",i[32]="click"},onOpen:function(){var t=e.getSelection(),n=t&&t.getStartElement(),i=new CKEDITOR.dom.elementPath(n),s;n=i.block||i.blockLimit||e.document.getBody();do s=n&&n.getComputedStyle(r=="back"?"background-color":"color")||"transparent";while(r=="back"&&s=="transparent"&&n&&(n=n.getParent()));if(!s||s=="transparent")s="#ffffff";this._.panel._.iframe.getFrameDocument().getById(o).setStyle("background-color",s)}})}function s(r,i,s){var u=[],a=t.colorButton_colors.split(","),f=CKEDITOR.tools.addFunction(function(n,i){if(n=="?"){var s=arguments.callee;function u(e){this.removeListener("ok",u),this.removeListener("cancel",u),e.name=="ok"&&s(this.getContentElement("picker","selectedColor").getValue(),i)}e.openDialog("colordialog",function(){this.on("ok",u),this.on("cancel",u)});return}e.focus(),r.hide(!1),e.fire("saveSnapshot"),(new CKEDITOR.style(t["colorButton_"+i+"Style"],{color:"inherit"})).remove(e.document);if(n){var a=t["colorButton_"+i+"Style"];a.childRule=i=="back"?function(e){return o(e)}:function(e){return!e.is("a")&&!e.getElementsByTag("a").count()||o(e)},(new CKEDITOR.style(a,{color:n})).apply(e.document)}e.fire("saveSnapshot")});u.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',n.auto,'" onclick="CKEDITOR.tools.callFunction(',f,",null,'",i,"');return false;\" href=\"javascript:void('",n.auto,'\')" role="option"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',s,'"></span></td><td colspan=7 align=center>',n.auto,'</td></tr></table></a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">');for(var l=0;l<a.length;l++){l%8===0&&u.push("</tr><tr>");var c=a[l].split("/"),h=c[0],p=c[1]||h;c[1]||(h="#"+h.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3"));var d=e.lang.colors[p]||p;u.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',d,'" onclick="CKEDITOR.tools.callFunction(',f,",'",h,"','",i,"'); return false;\" href=\"javascript:void('",d,'\')" role="option"><span class="cke_colorbox" style="background-color:#',p,'"></span></a></td>')}return(t.colorButton_enableMore===undefined||t.colorButton_enableMore)&&u.push('</tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',n.more,'" onclick="CKEDITOR.tools.callFunction(',f,",'?','",i,"');return false;\" href=\"javascript:void('",n.more,"')\"",' role="option">',n.more,"</a></td>"),u.push("</tr></table>"),u.join("")}function o(e){return e.getAttribute("contentEditable")=="false"||e.getAttribute("data-nostyle")}var t=e.config,n=e.lang.colorButton,r;CKEDITOR.env.hc||(i("TextColor","fore",n.textColorTitle),i("BGColor","back",n.bgColorTitle))}}),CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};