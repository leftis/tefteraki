/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
/**
 * @fileOverview The default editing block plugin, which holds the editing area
 *		and source view.
 */
(function(){var e;CKEDITOR.plugins.add("editingblock",{init:function(t){if(!t.config.editingBlock)return;t.on("themeSpace",function(e){e.data.space=="contents"&&(e.data.html+="<br>")}),t.on("themeLoaded",function(){t.fireOnce("editingBlockReady")}),t.on("uiReady",function(){t.setMode(t.config.startupMode)}),t.on("afterSetData",function(){if(!e){function n(){e=!0,t.getMode().loadData(t.getData()),e=!1}t.mode?n():t.on("mode",function(){t.mode&&(n(),t.removeListener("mode",arguments.callee))})}}),t.on("beforeGetData",function(){!e&&t.mode&&(e=!0,t.setData(t.getMode().getData(),null,1),e=!1)}),t.on("getSnapshot",function(e){t.mode&&(e.data=t.getMode().getSnapshotData())}),t.on("loadSnapshot",function(e){t.mode&&t.getMode().loadSnapshotData(e.data)}),t.on("mode",function(e){e.removeListener(),CKEDITOR.env.webkit&&t.container.on("focus",function(){t.focus()}),t.config.startupFocus&&t.focus(),setTimeout(function(){t.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,t)},0)}),t.on("destroy",function(){this.mode&&this._.modes[this.mode].unload(this.getThemeSpace("contents"))})}}),CKEDITOR.editor.prototype.mode="",CKEDITOR.editor.prototype.addMode=function(e,t){t.name=e,(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e){this.fire("beforeSetMode",{newMode:e});var t,n=this.getThemeSpace("contents"),r=this.checkDirty();if(this.mode){if(e==this.mode)return;this._.previousMode=this.mode,this.fire("beforeModeUnload");var i=this.getMode();t=i.getData(),i.unload(n),this.mode=""}n.setHtml("");var s=this.getMode(e);if(!s)throw'[CKEDITOR.editor.setMode] Unknown mode "'+e+'".';r||this.on("mode",function(){this.resetDirty(),this.removeListener("mode",arguments.callee)}),s.load(n,typeof t!="string"?this.getData():t)},CKEDITOR.editor.prototype.getMode=function(e){return this._.modes&&this._.modes[e||this.mode]},CKEDITOR.editor.prototype.focus=function(){this.forceNextSelectionCheck();var e=this.getMode();e&&e.focus()}})(),CKEDITOR.config.startupMode="wysiwyg",CKEDITOR.config.editingBlock=!0;