/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
(function(){function r(e,t){var r=n.exec(e),i=n.exec(t);if(r){if(!r[2]&&i[2]=="px")return i[1];if(r[2]=="px"&&!i[2])return i[1]+"px"}return t}var e=CKEDITOR.htmlParser.cssStyle,t=CKEDITOR.tools.cssLength,n=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,i={elements:{$:function(t){var n=t.attributes,i=n&&n["data-cke-realelement"],s=i&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(i)),o=s&&s.children[0];if(o&&t.attributes["data-cke-resizable"]){var u=(new e(t)).rules,a=o.attributes,f=u.width,l=u.height;f&&(a.width=r(a.width,f)),l&&(a.height=r(a.height,l))}return o}}};CKEDITOR.plugins.add("fakeobjects",{requires:["htmlwriter"],afterInit:function(e){var t=e.dataProcessor,n=t&&t.htmlFilter;n&&n.addRules(i)}}),CKEDITOR.editor.prototype.createFakeElement=function(n,r,i,s){var o=this.lang.fakeobjects,u=o[i]||o.unknown,a={"class":r,"data-cke-realelement":encodeURIComponent(n.getOuterHtml()),"data-cke-real-node-type":n.type,alt:u,title:u,align:n.getAttribute("align")||""};CKEDITOR.env.hc||(a.src=CKEDITOR.getUrl("images/spacer.gif")),i&&(a["data-cke-real-element-type"]=i);if(s){a["data-cke-resizable"]=s;var f=new e,l=n.getAttribute("width"),c=n.getAttribute("height");l&&(f.rules.width=t(l)),c&&(f.rules.height=t(c)),f.populate(a)}return this.document.createElement("img",{attributes:a})},CKEDITOR.editor.prototype.createFakeParserElement=function(n,r,i,s){var o=this.lang.fakeobjects,u=o[i]||o.unknown,a,f=new CKEDITOR.htmlParser.basicWriter;n.writeHtml(f),a=f.getHtml();var l={"class":r,"data-cke-realelement":encodeURIComponent(a),"data-cke-real-node-type":n.type,alt:u,title:u,align:n.attributes.align||""};CKEDITOR.env.hc||(l.src=CKEDITOR.getUrl("images/spacer.gif")),i&&(l["data-cke-real-element-type"]=i);if(s){l["data-cke-resizable"]=s;var c=n.attributes,h=new e,p=c.width,d=c.height;p!=undefined&&(h.rules.width=t(p)),d!=undefined&&(h.rules.height=t(d)),h.populate(l)}return new CKEDITOR.htmlParser.element("img",l)},CKEDITOR.editor.prototype.restoreRealElement=function(e){if(e.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var t=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(e.data("cke-realelement")),this.document);if(e.data("cke-resizable")){var n=e.getStyle("width"),i=e.getStyle("height");n&&t.setAttribute("width",r(t.getAttribute("width"),n)),i&&t.setAttribute("height",r(t.getAttribute("height"),i))}return t}})();