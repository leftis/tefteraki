/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
/**
 * @file Forms Plugin
 */
CKEDITOR.plugins.add("forms",{requires:["dialog"],init:function(e){var t=e.lang;e.addCss("form{border: 1px dotted #FF0000;padding: 2px;}\n"),e.addCss("img.cke_hidden{background-image: url("+CKEDITOR.getUrl(this.path+"images/hiddenfield.gif")+");"+"background-position: center center;"+"background-repeat: no-repeat;"+"border: 1px solid #a9a9a9;"+"width: 16px !important;"+"height: 16px !important;"+"}");var n=function(n,r,i){e.addCommand(r,new CKEDITOR.dialogCommand(r)),e.ui.addButton(n,{label:t.common[n.charAt(0).toLowerCase()+n.slice(1)],command:r}),CKEDITOR.dialog.add(r,i)},r=this.path+"dialogs/";n("Form","form",r+"form.js"),n("Checkbox","checkbox",r+"checkbox.js"),n("Radio","radio",r+"radio.js"),n("TextField","textfield",r+"textfield.js"),n("Textarea","textarea",r+"textarea.js"),n("Select","select",r+"select.js"),n("Button","button",r+"button.js"),n("ImageButton","imagebutton",CKEDITOR.plugins.getPath("image")+"dialogs/image.js"),n("HiddenField","hiddenfield",r+"hiddenfield.js"),e.addMenuItems&&e.addMenuItems({form:{label:t.form.menu,command:"form",group:"form"},checkbox:{label:t.checkboxAndRadio.checkboxTitle,command:"checkbox",group:"checkbox"},radio:{label:t.checkboxAndRadio.radioTitle,command:"radio",group:"radio"},textfield:{label:t.textfield.title,command:"textfield",group:"textfield"},hiddenfield:{label:t.hidden.title,command:"hiddenfield",group:"hiddenfield"},imagebutton:{label:t.image.titleButton,command:"imagebutton",group:"imagebutton"},button:{label:t.button.title,command:"button",group:"button"},select:{label:t.select.title,command:"select",group:"select"},textarea:{label:t.textarea.title,command:"textarea",group:"textarea"}}),e.contextMenu&&(e.contextMenu.addListener(function(e){if(e&&e.hasAscendant("form",!0)&&!e.isReadOnly())return{form:CKEDITOR.TRISTATE_OFF}}),e.contextMenu.addListener(function(e){if(e&&!e.isReadOnly()){var t=e.getName();if(t=="select")return{select:CKEDITOR.TRISTATE_OFF};if(t=="textarea")return{textarea:CKEDITOR.TRISTATE_OFF};if(t=="input")switch(e.getAttribute("type")){case"button":case"submit":case"reset":return{button:CKEDITOR.TRISTATE_OFF};case"checkbox":return{checkbox:CKEDITOR.TRISTATE_OFF};case"radio":return{radio:CKEDITOR.TRISTATE_OFF};case"image":return{imagebutton:CKEDITOR.TRISTATE_OFF};default:return{textfield:CKEDITOR.TRISTATE_OFF}}if(t=="img"&&e.data("cke-real-element-type")=="hiddenfield")return{hiddenfield:CKEDITOR.TRISTATE_OFF}}})),e.on("doubleclick",function(e){var t=e.data.element;if(t.is("form"))e.data.dialog="form";else if(t.is("select"))e.data.dialog="select";else if(t.is("textarea"))e.data.dialog="textarea";else if(t.is("img")&&t.data("cke-real-element-type")=="hiddenfield")e.data.dialog="hiddenfield";else if(t.is("input"))switch(t.getAttribute("type")){case"button":case"submit":case"reset":e.data.dialog="button";break;case"checkbox":e.data.dialog="checkbox";break;case"radio":e.data.dialog="radio";break;case"image":e.data.dialog="imagebutton";break;default:e.data.dialog="textfield"}})},afterInit:function(e){var t=e.dataProcessor,n=t&&t.htmlFilter,r=t&&t.dataFilter;CKEDITOR.env.ie&&n&&n.addRules({elements:{input:function(e){var t=e.attributes,n=t.type;n||(t.type="text"),(n=="checkbox"||n=="radio")&&t.value=="on"&&delete t.value}}}),r&&r.addRules({elements:{input:function(t){if(t.attributes.type=="hidden")return e.createFakeParserElement(t,"cke_hidden","hiddenfield")}}})},requires:["image","fakeobjects"]}),CKEDITOR.env.ie&&(CKEDITOR.dom.element.prototype.hasAttribute=CKEDITOR.tools.override(CKEDITOR.dom.element.prototype.hasAttribute,function(e){return function(t){var n=this.$.attributes.getNamedItem(t);if(this.getName()=="input")switch(t){case"class":return this.$.className.length>0;case"checked":return!!this.$.checked;case"value":var r=this.getAttribute("type");return r=="checkbox"||r=="radio"?this.$.value!="on":this.$.value}return e.apply(this,arguments)}}));