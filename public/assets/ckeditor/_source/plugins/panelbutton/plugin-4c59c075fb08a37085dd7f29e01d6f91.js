/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
CKEDITOR.plugins.add("panelbutton",{requires:["button"],onLoad:function(){function e(e){var t=this._;if(t.state==CKEDITOR.TRISTATE_DISABLED)return;this.createPanel(e);if(t.on){t.panel.hide();return}t.panel.showBlock(this._.id,this.document.getById(this._.id),4)}CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){var n=t.panel;delete t.panel,this.base(t),this.document=n&&n.parent&&n.parent.getDocument()||CKEDITOR.document,n.block={attributes:n.attributes},this.hasArrow=!0,this.click=e,this._={panelDefinition:n}},statics:{handler:{create:function(e){return new CKEDITOR.ui.panelButton(e)}}},proto:{createPanel:function(e){var t=this._;if(t.panel)return;var n=this._.panelDefinition||{},r=this._.panelDefinition.block,i=n.parent||CKEDITOR.document.getBody(),s=this._.panel=new CKEDITOR.ui.floatPanel(e,i,n),o=s.addBlock(t.id,r),u=this;s.onShow=function(){u.className&&this.element.getFirst().addClass(u.className+"_panel"),u.setState(CKEDITOR.TRISTATE_ON),t.on=1,u.onOpen&&u.onOpen()},s.onHide=function(n){u.className&&this.element.getFirst().removeClass(u.className+"_panel"),u.setState(u.modes&&u.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),t.on=0,!n&&u.onClose&&u.onClose()},s.onEscape=function(){s.hide(),u.document.getById(t.id).focus()},this.onBlock&&this.onBlock(s,o),o.onHide=function(){t.on=0,u.setState(CKEDITOR.TRISTATE_OFF)}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}}),CKEDITOR.UI_PANELBUTTON="panelbutton";