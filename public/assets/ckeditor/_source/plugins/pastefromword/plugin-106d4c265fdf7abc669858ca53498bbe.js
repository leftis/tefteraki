/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
(function(){function e(e){e.data.mode="html"}CKEDITOR.plugins.add("pastefromword",{init:function(t){var n=0,r=function(r){r&&r.removeListener(),t.removeListener("beforePaste",e),n&&setTimeout(function(){n=0},0)};t.addCommand("pastefromword",{canUndo:!1,exec:function(){n=1,t.on("beforePaste",e),t.execCommand("paste","html")===!1&&(t.on("dialogShow",function(e){e.removeListener(),e.data.on("cancel",r)}),t.on("dialogHide",function(e){e.data.removeListener("cancel",r)})),t.on("afterPaste",r)}}),t.ui.addButton("PasteFromWord",{label:t.lang.pastefromword.toolbar,command:"pastefromword"}),t.on("pasteState",function(e){t.getCommand("pastefromword").setState(e.data)}),t.on("paste",function(e){var r=e.data,i;if((i=r.html)&&(n||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(i))){var s=this.loadFilterRules(function(){if(s)t.fire("paste",r);else if(!t.config.pasteFromWordPromptCleanup||n||confirm(t.lang.pastefromword.confirmCleanup))r.html=CKEDITOR.cleanWord(i,t)});s&&e.cancel()}},this)},loadFilterRules:function(e){var t=CKEDITOR.cleanWord;if(t)e();else{var n=CKEDITOR.getUrl(CKEDITOR.config.pasteFromWordCleanupFile||this.path+"filter/default.js");CKEDITOR.scriptLoader.load(n,e,null,!0)}return!t},requires:["clipboard"]})})();